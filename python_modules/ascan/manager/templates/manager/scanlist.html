{% extends 'scan/base.html' %}
{% load bootstrap4 %}
{% load crispy_forms_tags %}
{% load static %}

{% block page_title %}Scans{% endblock %}

{% block scripts %}
<script type="application/javascript" src="{% static 'js/list.min.js' %}"></script>
{% endblock %}

{% block container %}
<h2>Scans on the site</h2>

Here you can see scans and crawls enlarging our index (currently and recently).

<div class="list-group list-group-flush">
   {% for scan, page_count in scans %}
   <a href="/manager/scaninfo?job_id={{ scan.id }}"
      class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
      <span>
         <strong>{{ scan.query_phrase }}</strong>
         {% if scan.query_tags %}{{ scan.query_tags }}{% endif %}
         {% if scan.query_site_names %}<em>{{ scan.query_site_names }}</em>{% endif %}
         <span class="badge badge-primary">{{ scan.status }}</span>
         <small>({{ scan.status_changed }})</small>
      </span>
      <span class="badge badge-dark badge-pill">{{ page_count }}</span>
   </a>
  {% endfor %}
</div>

{% if form %}
<div class="card p-2">
<h3>Start a new simple crawl</h3>
{% crispy form %}
</div>
<script defer type="application/javascript">
   var options = {
      valueNames: [ 'possible-choice' ]
   };

   var siteList = new List('crawl_site-searchable', options)
</script>
{% endif %}
{% endblock %}
